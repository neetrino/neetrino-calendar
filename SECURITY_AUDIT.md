# SECURITY_AUDIT.md

**–î–∞—Ç–∞ –∞—É–¥–∏—Ç–∞:** 23.01.2026  
**–ü—Ä–æ–µ–∫—Ç:** Calendar App (Next.js 15, App Router, Prisma + SQLite)  
**–ê—É–¥–∏—Ç–æ—Ä:** Security Hardening Process

---

## EXECUTIVE SUMMARY

–ü—Ä–æ–≤–µ–¥–µ–Ω –ø–æ–ª–Ω—ã–π security audit Next.js –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è. –û–±–Ω–∞—Ä—É–∂–µ–Ω–æ **12 –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö (P0)**, **8 –≤—ã—Å–æ–∫–∏—Ö (P1)** –∏ **5 —Å—Ä–µ–¥–Ω–∏—Ö (P2)** —Ä–∏—Å–∫–æ–≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏. –í—Å–µ —Ä–∏—Å–∫–∏ —Ç—Ä–µ–±—É—é—Ç –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ–≥–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–µ—Ä–µ–¥ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–æ–º.

**–û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:** üî¥ **–ö–†–ò–¢–ò–ß–ù–û** ‚Äî –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ –≥–æ—Ç–æ–≤–æ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É –±–µ–∑ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π.

---

## THREAT MODEL

### –ê–∫—Ç–∏–≤—ã (Assets)
1. **User Accounts & Sessions** ‚Äî –∞–∫–∫–∞—É–Ω—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, —Å–µ—Å—Å–∏–∏, —Ä–æ–ª–∏ (ADMIN/USER)
2. **PII Data** ‚Äî email, –∏–º–µ–Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
3. **Calendar Data** ‚Äî –≤—Å—Ç—Ä–µ—á–∏, –¥–µ–¥–ª–∞–π–Ω—ã, —É—á–∞—Å—Ç–Ω–∏–∫–∏
4. **Schedule Data** ‚Äî –≥—Ä–∞—Ñ–∏–∫ —Ä–∞–±–æ—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
5. **Permissions** ‚Äî —Å–∏—Å—Ç–µ–º–∞ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π (UserPermission)
6. **Admin Access** ‚Äî –¥–æ—Å—Ç—É–ø –∫ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏

### –£–≥—Ä–æ–∑—ã (Threats)
1. **Unauthorized Access** ‚Äî –¥–æ—Å—Ç—É–ø –∫ —á—É–∂–∏–º –¥–∞–Ω–Ω—ã–º (IDOR)
2. **Privilege Escalation** ‚Äî –ø–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–∞–≤ –∞–¥–º–∏–Ω–∞
3. **Session Hijacking** ‚Äî –ø–µ—Ä–µ—Ö–≤–∞—Ç —Å–µ—Å—Å–∏–π
4. **Brute Force** ‚Äî –ø–æ–¥–±–æ—Ä –ø–∞—Ä–æ–ª–µ–π/email
5. **Data Enumeration** ‚Äî –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π/–¥–∞–Ω–Ω—ã—Ö
6. **CSRF Attacks** ‚Äî –ø–æ–¥–¥–µ–ª–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤
7. **XSS** ‚Äî –≤–Ω–µ–¥—Ä–µ–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–æ–≤
8. **Information Disclosure** ‚Äî —É—Ç–µ—á–∫–∞ stack traces, —Å–µ–∫—Ä–µ—Ç–æ–≤

---

## –î–ï–¢–ê–õ–¨–ù–´–ô –ê–ù–ê–õ–ò–ó –†–ò–°–ö–û–í

### üî¥ P0 ‚Äî –ö–†–ò–¢–ò–ß–ù–´–ï –†–ò–°–ö–ò (—Ç—Ä–µ–±—É—é—Ç –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ–≥–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è)

#### P0-1: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ Security Headers
**–ì–¥–µ:** `next.config.ts` (–ø—É—Å—Ç–æ–π), `src/middleware.ts` (—Ç–æ–ª—å–∫–æ auth check)  
**–†–∏—Å–∫:** XSS, clickjacking, MIME sniffing, data leakage  
**–≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è:**
- –ó–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –º–æ–∂–µ—Ç –≤–Ω–µ–¥—Ä–∏—Ç—å iframe —Å –≤–∞—à–∏–º —Å–∞–π—Ç–æ–º (clickjacking)
- –ë—Ä–∞—É–∑–µ—Ä –º–æ–∂–µ—Ç –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä–æ–≤–∞—Ç—å MIME —Ç–∏–ø—ã
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ CSP –ø–æ–∑–≤–æ–ª—è–µ—Ç XSS –∞—Ç–∞–∫–∏
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ HSTS –ø–æ–∑–≤–æ–ª—è–µ—Ç downgrade –Ω–∞ HTTP

**–§–∏–∫—Å:**
- –î–æ–±–∞–≤–∏—Ç—å Content-Security-Policy –≤ `next.config.ts`
- –î–æ–±–∞–≤–∏—Ç—å X-Frame-Options: DENY
- –î–æ–±–∞–≤–∏—Ç—å X-Content-Type-Options: nosniff
- –î–æ–±–∞–≤–∏—Ç—å Referrer-Policy: strict-origin-when-cross-origin
- –î–æ–±–∞–≤–∏—Ç—å Permissions-Policy
- –î–æ–±–∞–≤–∏—Ç—å Strict-Transport-Security (–¥–ª—è prod)

**–§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- `next.config.ts`
- `src/middleware.ts`

---

#### P0-2: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ Rate Limiting
**–ì–¥–µ:** –í—Å–µ API endpoints, –æ—Å–æ–±–µ–Ω–Ω–æ `/api/auth/login`  
**–†–∏—Å–∫:** Brute force –∞—Ç–∞–∫–∏, DoS, enumeration  
**–≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è:**
- –ó–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –º–æ–∂–µ—Ç –±—Ä—É—Ç—Ñ–æ—Ä—Å–∏—Ç—å email –∞–¥—Ä–µ—Å–∞ (1000+ –∑–∞–ø—Ä–æ—Å–æ–≤/—Å–µ–∫)
- DoS –∞—Ç–∞–∫–∞ –Ω–∞ –ª—é–±–æ–π endpoint
- Enumeration –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —á–µ—Ä–µ–∑ login endpoint

**–§–∏–∫—Å:**
- –í–Ω–µ–¥—Ä–∏—Ç—å rate limiting –Ω–∞ –≤—Å–µ –ø—É–±–ª–∏—á–Ω—ã–µ endpoints
- –°—Ç—Ä–æ–≥–∏–µ –ª–∏–º–∏—Ç—ã –Ω–∞ `/api/auth/login` (5 –ø–æ–ø—ã—Ç–æ–∫/–º–∏–Ω—É—Ç—É –ø–æ IP)
- –ì–ª–æ–±–∞–ª—å–Ω—ã–π –ª–∏–º–∏—Ç –Ω–∞ API (100 req/min –ø–æ IP)
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Vercel-compatible —Ä–µ—à–µ–Ω–∏–µ (Edge-compatible)

**–§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- –°–æ–∑–¥–∞—Ç—å `src/lib/rateLimit.ts`
- –û–±–Ω–æ–≤–∏—Ç—å –≤—Å–µ API routes

---

#### P0-3: Email Enumeration –≤ Login Endpoint
**–ì–¥–µ:** `src/app/api/auth/login/route.ts:24`  
**–†–∏—Å–∫:** Information disclosure, user enumeration  
**–≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è:**
- –†–∞–∑–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã –¥–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö/–Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö email:
  - –°—É—â–µ—Å—Ç–≤—É—é—â–∏–π: `{ error: "User not found" }` (404)
  - –ù–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π: `{ error: "User not found" }` (404) ‚Äî –Ω–æ –≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞ –º–æ–∂–µ—Ç –æ—Ç–ª–∏—á–∞—Ç—å—Å—è
- –ó–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –º–æ–∂–µ—Ç –ø–µ—Ä–µ—á–∏—Å–ª–∏—Ç—å –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

**–§–∏–∫—Å:**
- –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –æ—Ç–≤–µ—Ç—ã (–æ–¥–∏–Ω–∞–∫–æ–≤–æ–µ –≤—Ä–µ–º—è, –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π —Ñ–æ—Ä–º–∞—Ç)
- –í—Å–µ–≥–¥–∞ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å 200 OK —Å generic —Å–æ–æ–±—â–µ–Ω–∏–µ–º
- –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å failed attempts –±–µ–∑ —Ä–∞–∑–ª–∏—á–∏—è —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**–§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- `src/app/api/auth/login/route.ts`

---

#### P0-4: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ CSRF –ó–∞—â–∏—Ç—ã
**–ì–¥–µ:** –í—Å–µ POST/PUT/PATCH/DELETE endpoints  
**–†–∏—Å–∫:** Cross-Site Request Forgery  
**–≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è:**
- –ó–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –º–æ–∂–µ—Ç –∑–∞—Å—Ç–∞–≤–∏—Ç—å –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤—ã–ø–æ–ª–Ω–∏—Ç—å –¥–µ–π—Å—Ç–≤–∏—è –æ—Ç –µ–≥–æ –∏–º–µ–Ω–∏
- –ü—Ä–∏–º–µ—Ä: `<img src="https://yourapp.com/api/calendar/items/123" method="DELETE">` –Ω–∞ –¥—Ä—É–≥–æ–º —Å–∞–π—Ç–µ

**–§–∏–∫—Å:**
- –î–æ–±–∞–≤–∏—Ç—å CSRF —Ç–æ–∫–µ–Ω—ã –¥–ª—è state-changing –æ–ø–µ—Ä–∞—Ü–∏–π
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å SameSite=Strict –¥–ª—è cookies (–≥–¥–µ –≤–æ–∑–º–æ–∂–Ω–æ)
- –ü—Ä–æ–≤–µ—Ä—è—Ç—å Origin/Referer headers

**–§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- –°–æ–∑–¥–∞—Ç—å `src/lib/csrf.ts`
- –û–±–Ω–æ–≤–∏—Ç—å middleware
- –û–±–Ω–æ–≤–∏—Ç—å –≤—Å–µ –º—É—Ç–∏—Ä—É—é—â–∏–µ API routes

---

#### P0-5: IDOR (Insecure Direct Object Reference)
**–ì–¥–µ:** 
- `src/app/api/calendar/items/[id]/route.ts` ‚Äî –Ω–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤–ª–∞–¥–µ–ª—å—Ü–∞
- `src/app/api/schedule/[id]/route.ts` ‚Äî –Ω–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤–ª–∞–¥–µ–ª—å—Ü–∞
- `src/app/api/calendar/items/route.ts` ‚Äî GET –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –í–°–ï items –±–µ–∑ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é

**–†–∏—Å–∫:** –î–æ—Å—Ç—É–ø –∫ —á—É–∂–∏–º –¥–∞–Ω–Ω—ã–º  
**–≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è:**
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ —á—É–∂–∏–º calendar items —á–µ—Ä–µ–∑ –ø—Ä—è–º–æ–π ID
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –≤–∏–¥–µ—Ç—å –≤—Å–µ calendar items –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω—è—Ç—å/—É–¥–∞–ª—è—Ç—å —á—É–∂–∏–µ –∑–∞–ø–∏—Å–∏

**–§–∏–∫—Å:**
- –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –≤–ª–∞–¥–µ–ª—å—Ü–∞/—É—á–∞—Å—Ç–Ω–∏–∫–∞ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä–µ—Å—É—Ä—Å–∞
- –§–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å GET –∑–∞–ø—Ä–æ—Å—ã –ø–æ –ø—Ä–∞–≤–∞–º –¥–æ—Å—Ç—É–ø–∞ (UserPermission)
- –°–æ–∑–¥–∞—Ç—å –µ–¥–∏–Ω—ã–π —Å–ª–æ–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ `src/lib/authorize.ts`

**–§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- –°–æ–∑–¥–∞—Ç—å `src/lib/authorize.ts`
- –û–±–Ω–æ–≤–∏—Ç—å `src/app/api/calendar/items/route.ts`
- –û–±–Ω–æ–≤–∏—Ç—å `src/app/api/calendar/items/[id]/route.ts`
- –û–±–Ω–æ–≤–∏—Ç—å `src/app/api/schedule/[id]/route.ts`

---

#### P0-6: –£—Ç–µ—á–∫–∞ Stack Traces –≤ Production
**–ì–¥–µ:** –í—Å–µ API routes (–Ω–∞–ø—Ä–∏–º–µ—Ä, `src/app/api/calendar/items/route.ts:88-91`)  
**–†–∏—Å–∫:** Information disclosure, —Ä–∞—Å–∫—Ä—ã—Ç–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ë–î, –ø—É—Ç–µ–π, —Å–µ–∫—Ä–µ—Ç–æ–≤  
**–≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è:**
- –í production –æ—à–∏–±–∫–∏ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç –ø–æ–ª–Ω—ã–µ stack traces
- Stack traces –º–æ–≥—É—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –ø—É—Ç–∏ –∫ —Ñ–∞–π–ª–∞–º, –∏–º–µ–Ω–∞ —Ç–∞–±–ª–∏—Ü, SQL –∑–∞–ø—Ä–æ—Å—ã

**–§–∏–∫—Å:**
- –°–æ–∑–¥–∞—Ç—å –µ–¥–∏–Ω—ã–π error handler
- –í production –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å generic –æ—à–∏–±–∫–∏
- –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –¥–µ—Ç–∞–ª–∏ —Ç–æ–ª—å–∫–æ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
- Redact —Å–µ–∫—Ä–µ—Ç—ã –∏–∑ –ª–æ–≥–æ–≤

**–§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- –°–æ–∑–¥–∞—Ç—å `src/lib/errors.ts`
- –û–±–Ω–æ–≤–∏—Ç—å –≤—Å–µ API routes

---

#### P0-7: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –í–∞–ª–∏–¥–∞—Ü–∏–∏ Environment Variables
**–ì–¥–µ:** `.env.example`, –Ω–µ—Ç runtime validation  
**–†–∏—Å–∫:** –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –º–æ–∂–µ—Ç –∑–∞–ø—É—Å—Ç–∏—Ç—å—Å—è —Å –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–º–∏/–æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–º–∏ env  
**–≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è:**
- –ï—Å–ª–∏ `AUTH_SECRET` –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∏–ª–∏ —Å–ª–∞–±—ã–π ‚Äî —Å–µ—Å—Å–∏–∏ –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω—ã
- –ï—Å–ª–∏ `DATABASE_URL` –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–π ‚Äî –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —É–ø–∞–¥–µ—Ç –≤ runtime

**–§–∏–∫—Å:**
- –°–æ–∑–¥–∞—Ç—å `src/lib/env.ts` —Å zod validation
- –í–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å env –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- –û–±–Ω–æ–≤–∏—Ç—å `.env.example` —Å –æ–ø–∏—Å–∞–Ω–∏—è–º–∏

**–§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- –°–æ–∑–¥–∞—Ç—å `src/lib/env.ts`
- –û–±–Ω–æ–≤–∏—Ç—å `.env.example`

---

#### P0-8: –°–ª–∞–±–∞—è Cookie Security
**–ì–¥–µ:** `src/app/api/auth/login/route.ts:30-35`  
**–†–∏—Å–∫:** Session hijacking, XSS  
**–≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è:**
- Cookie –±–µ–∑ `SameSite=Strict` —É—è–∑–≤–∏–º –∫ CSRF
- `secure` —Ç–æ–ª—å–∫–æ –≤ production ‚Äî –≤ dev –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–µ—Ä–µ—Ö–≤–∞—á–µ–Ω

**–§–∏–∫—Å:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `SameSite=Strict` –¥–ª—è auth cookies
- –î–æ–±–∞–≤–∏—Ç—å `path` —è–≤–Ω–æ
- –†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ `__Host-` –ø—Ä–µ—Ñ–∏–∫—Å–∞

**–§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- `src/app/api/auth/login/route.ts`

---

#### P0-9: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ó–∞—â–∏—Ç—ã –æ—Ç Timing Attacks
**–ì–¥–µ:** `src/lib/auth.ts:21-25` (findUnique –ø–æ userId)  
**–†–∏—Å–∫:** User enumeration —á–µ—Ä–µ–∑ timing  
**–≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è:**
- –†–∞–∑–Ω–æ–µ –≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞ –¥–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö/–Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö userId –º–æ–∂–µ—Ç —Ä–∞—Å–∫—Ä—ã—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é

**–§–∏–∫—Å:**
- –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å constant-time —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –≥–¥–µ –≤–æ–∑–º–æ–∂–Ω–æ

**–§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- `src/lib/auth.ts`

---

#### P0-10: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
**–ì–¥–µ:** –í—Å–µ API routes –∏—Å–ø–æ–ª—å–∑—É—é—Ç `console.log/error`  
**–†–∏—Å–∫:** –£—Ç–µ—á–∫–∞ PII, —Å–µ–∫—Ä–µ—Ç–æ–≤ –≤ –ª–æ–≥–∏, —Å–ª–æ–∂–Ω–æ—Å—Ç—å –∞—É–¥–∏—Ç–∞  
**–≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è:**
- –õ–æ–≥–∏ –º–æ–≥—É—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å email, userId, —Ç–æ–∫–µ–Ω—ã
- –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –æ—Ç—Å–ª–µ–¥–∏—Ç—å security events (failed logins, unauthorized access)

**–§–∏–∫—Å:**
- –°–æ–∑–¥–∞—Ç—å structured logger
- Redact PII –∏ —Å–µ–∫—Ä–µ—Ç—ã
- –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å security events –æ—Ç–¥–µ–ª—å–Ω–æ

**–§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- –°–æ–∑–¥–∞—Ç—å `src/lib/logger.ts`
- –û–±–Ω–æ–≤–∏—Ç—å –≤—Å–µ API routes

---

#### P0-11: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ó–∞—â–∏—Ç—ã –æ—Ç Mass Assignment
**–ì–¥–µ:** –í—Å–µ POST/PATCH endpoints  
**–†–∏—Å–∫:** –ü–µ—Ä–µ–∑–∞–ø–∏—Å—å –∑–∞—â–∏—â–µ–Ω–Ω—ã—Ö –ø–æ–ª–µ–π (role, createdById)  
**–≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è:**
- –•–æ—Ç—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è zod, –Ω—É–∂–Ω–æ —É–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ –≤—Å–µ –ø–æ–ª—è —Å—Ç—Ä–æ–≥–æ –≤–∞–ª–∏–¥–∏—Ä—É—é—Ç—Å—è
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –ø–æ–ø—ã—Ç–∞—Ç—å—Å—è –ø–µ—Ä–µ–¥–∞—Ç—å `role: "ADMIN"` –≤ body

**–°—Ç–∞—Ç—É—Å:** –ß–∞—Å—Ç–∏—á–Ω–æ –∑–∞—â–∏—â–µ–Ω–æ —á–µ—Ä–µ–∑ zod, –Ω–æ –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ endpoints

**–§–∏–∫—Å:**
- –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ –≤—Å–µ —Å—Ö–µ–º—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç `.strip()` –¥–ª—è –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω—ã—Ö –ø–æ–ª–µ–π
- –Ø–≤–Ω–æ –≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å —á—Ç–æ –∑–∞—â–∏—â–µ–Ω–Ω—ã–µ –ø–æ–ª—è –Ω–µ –º–æ–≥—É—Ç –±—ã—Ç—å –∏–∑–º–µ–Ω–µ–Ω—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º

**–§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ validation schemas
- –û–±–Ω–æ–≤–∏—Ç—å –≥–¥–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ

---

#### P0-12: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ Dependency Security Checks
**–ì–¥–µ:** `package.json`, –Ω–µ—Ç CI checks  
**–†–∏—Å–∫:** –£—è–∑–≤–∏–º–æ—Å—Ç–∏ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è—Ö  
**–≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è:**
- –°—Ç–∞—Ä—ã–µ –≤–µ—Ä—Å–∏–∏ –ø–∞–∫–µ—Ç–æ–≤ –º–æ–≥—É—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –∏–∑–≤–µ—Å—Ç–Ω—ã–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏
- –ù–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π

**–§–∏–∫—Å:**
- –î–æ–±–∞–≤–∏—Ç—å `npm audit` –≤ CI
- –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Dependabot (–µ—Å–ª–∏ GitHub)
- –ó–∞–∫—Ä–µ–ø–∏—Ç—å –≤–µ—Ä—Å–∏–∏ –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –ø–∞–∫–µ—Ç–æ–≤

**–§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- –°–æ–∑–¥–∞—Ç—å `.github/dependabot.yml` (–µ—Å–ª–∏ GitHub)
- –û–±–Ω–æ–≤–∏—Ç—å CI –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é

---

### üü† P1 ‚Äî –í–´–°–û–ö–ò–ï –†–ò–°–ö–ò

#### P1-1: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ Input Sanitization –¥–ª—è XSS
**–ì–¥–µ:** –í—Å–µ —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –ø–æ–ª—è (title, description, location, note)  
**–†–∏—Å–∫:** XSS —á–µ—Ä–µ–∑ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ  
**–°—Ç–∞—Ç—É—Å:** React –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —ç–∫—Ä–∞–Ω–∏—Ä—É–µ—Ç, –Ω–æ –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å `dangerouslySetInnerHTML`

**–§–∏–∫—Å:**
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `dangerouslySetInnerHTML`
- –î–æ–±–∞–≤–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—É—é —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—é –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –µ—Å–ª–∏ –Ω—É–∂–Ω–æ

---

#### P1-2: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ Pagination Limits
**–ì–¥–µ:** `src/app/api/calendar/items/route.ts:56` (findMany –±–µ–∑ take)  
**–†–∏—Å–∫:** DoS —á–µ—Ä–µ–∑ –±–æ–ª—å—à–∏–µ –∑–∞–ø—Ä–æ—Å—ã  
**–≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è:**
- –ó–∞–ø—Ä–æ—Å –º–æ–∂–µ—Ç –≤–µ—Ä–Ω—É—Ç—å –º–∏–ª–ª–∏–æ–Ω—ã –∑–∞–ø–∏—Å–µ–π, –ø–µ—Ä–µ–≥—Ä—É–∑–∏–≤ —Å–µ—Ä–≤–µ—Ä/–∫–ª–∏–µ–Ω—Ç

**–§–∏–∫—Å:**
- –î–æ–±–∞–≤–∏—Ç—å max limit (–Ω–∞–ø—Ä–∏–º–µ—Ä, 1000)
- –î–æ–±–∞–≤–∏—Ç—å pagination (cursor-based –∏–ª–∏ offset)

**–§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- `src/app/api/calendar/items/route.ts`
- `src/app/api/users/route.ts`
- `src/app/api/schedule/route.ts`

---

#### P1-3: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ó–∞—â–∏—Ç—ã Admin Routes –≤ Middleware
**–ì–¥–µ:** `src/middleware.ts` ‚Äî –Ω–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–æ–ª–∏ –¥–ª—è `/admin/*`  
**–†–∏—Å–∫:** –î–æ—Å—Ç—É–ø –∫ –∞–¥–º–∏–Ω–∫–µ –¥–ª—è –Ω–µ-–∞–¥–º–∏–Ω–æ–≤ (–µ—Å–ª–∏ frontend –∑–∞—â–∏—Ç–∞ –æ–±–æ–π–¥–µ–Ω–∞)  
**–°—Ç–∞—Ç—É—Å:** –ó–∞—â–∏—Ç–∞ –µ—Å—Ç—å –Ω–∞ —É—Ä–æ–≤–Ω–µ API, –Ω–æ middleware –¥–æ–ª–∂–µ–Ω –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–Ω—å—à–µ

**–§–∏–∫—Å:**
- –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É —Ä–æ–ª–∏ –≤ middleware –¥–ª—è `/admin/*` routes

**–§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- `src/middleware.ts`

---

#### P1-4: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ Idempotency –¥–ª—è Mutations
**–ì–¥–µ:** –í—Å–µ POST/PATCH endpoints  
**–†–∏—Å–∫:** –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–π –ø—Ä–∏ retry  
**–≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è:**
- –ö–ª–∏–µ–Ω—Ç –º–æ–∂–µ—Ç –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞–ø—Ä–æ—Å –¥–≤–∞–∂–¥—ã (network retry)
- –°–æ–∑–¥–∞–¥—É—Ç—Å—è –¥—É–±–ª–∏–∫–∞—Ç—ã –∑–∞–ø–∏—Å–µ–π

**–§–∏–∫—Å:**
- –î–æ–±–∞–≤–∏—Ç—å idempotency keys –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- –ü—Ä–æ–≤–µ—Ä—è—Ç—å –¥—É–±–ª–∏–∫–∞—Ç—ã –ø–µ—Ä–µ–¥ —Å–æ–∑–¥–∞–Ω–∏–µ–º

---

#### P1-5: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ Request Timeout
**–ì–¥–µ:** –í—Å–µ API routes  
**–†–∏—Å–∫:** DoS —á–µ—Ä–µ–∑ –¥–æ–ª–≥–∏–µ –∑–∞–ø—Ä–æ—Å—ã  
**–≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è:**
- –ó–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –º–æ–∂–µ—Ç –¥–µ—Ä–∂–∞—Ç—å —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –æ—Ç–∫—Ä—ã—Ç—ã–º

**–§–∏–∫—Å:**
- –ù–∞—Å—Ç—Ä–æ–∏—Ç—å timeout –Ω–∞ —É—Ä–æ–≤–Ω–µ Next.js/Vercel
- –î–æ–±–∞–≤–∏—Ç—å —è–≤–Ω—ã–µ timeout –¥–ª—è –¥–æ–ª–≥–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

---

#### P1-6: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ CORS –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
**–ì–¥–µ:** `next.config.ts`  
**–†–∏—Å–∫:** –ù–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–µ CORS –ø–æ–ª–∏—Ç–∏–∫–∏  
**–°—Ç–∞—Ç—É—Å:** Next.js –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —Ä–∞–∑—Ä–µ—à–∞–µ—Ç —Ç–æ–ª—å–∫–æ same-origin, –Ω–æ –Ω—É–∂–Ω–æ —è–≤–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å

**–§–∏–∫—Å:**
- –Ø–≤–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å CORS –µ—Å–ª–∏ –Ω—É–∂–µ–Ω cross-origin –¥–æ—Å—Ç—É–ø
- –ò–Ω–∞—á–µ —É–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ —Ç–æ–ª—å–∫–æ same-origin —Ä–∞–∑—Ä–µ—à–µ–Ω

---

#### P1-7: SQL Injection (–ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ)
**–ì–¥–µ:** Prisma queries  
**–°—Ç–∞—Ç—É—Å:** Prisma –∑–∞—â–∏—â–∞–µ—Ç –æ—Ç SQL injection, –Ω–æ –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `$queryRaw`

**–§–∏–∫—Å:**
- –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ –Ω–µ—Ç `$queryRaw` –±–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–∞—Ü–∏–∏
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ Prisma queries

---

#### P1-8: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ Audit Logging
**–ì–¥–µ:** –ù–µ—Ç –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π  
**–†–∏—Å–∫:** –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –æ—Ç—Å–ª–µ–¥–∏—Ç—å –∫—Ç–æ —á—Ç–æ –∏–∑–º–µ–Ω–∏–ª  
**–≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è:**
- –ù–µ—Ç –∏—Å—Ç–æ—Ä–∏–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π permissions
- –ù–µ—Ç –∏—Å—Ç–æ—Ä–∏–∏ —É–¥–∞–ª–µ–Ω–∏—è calendar items

**–§–∏–∫—Å:**
- –î–æ–±–∞–≤–∏—Ç—å audit log –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π (permissions, deletions)

---

### üü° P2 ‚Äî –°–†–ï–î–ù–ò–ï –†–ò–°–ö–ò

#### P2-1: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ File Upload –ó–∞—â–∏—Ç—ã
**–ì–¥–µ:** –ù–µ—Ç file upload —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞  
**–°—Ç–∞—Ç—É—Å:** –ù–µ –ø—Ä–∏–º–µ–Ω–∏–º–æ —Å–µ–π—á–∞—Å, –Ω–æ –Ω—É–∂–Ω–æ —É—á–µ—Å—Ç—å –µ—Å–ª–∏ –¥–æ–±–∞–≤–∏—Ç—Å—è

---

#### P2-2: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ SSRF –ó–∞—â–∏—Ç—ã
**–ì–¥–µ:** –ù–µ—Ç –≤–Ω–µ—à–Ω–∏—Ö HTTP –∑–∞–ø—Ä–æ—Å–æ–≤ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è  
**–°—Ç–∞—Ç—É—Å:** –ù–µ –ø—Ä–∏–º–µ–Ω–∏–º–æ —Å–µ–π—á–∞—Å, –Ω–æ –Ω—É–∂–Ω–æ —É—á–µ—Å—Ç—å –µ—Å–ª–∏ –¥–æ–±–∞–≤–∏—Ç—Å—è

---

#### P2-3: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ Webhook Signature Verification
**–ì–¥–µ:** –ù–µ—Ç webhook endpoints  
**–°—Ç–∞—Ç—É—Å:** –ù–µ –ø—Ä–∏–º–µ–Ω–∏–º–æ —Å–µ–π—á–∞—Å

---

#### P2-4: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ Rate Limiting –Ω–∞ Frontend
**–ì–¥–µ:** Client-side –∫–æ–¥  
**–†–∏—Å–∫:** –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã —Å –∫–ª–∏–µ–Ω—Ç–∞  
**–°—Ç–∞—Ç—É—Å:** –ó–∞—â–∏—Ç–∞ –Ω–∞ backend –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–∞, –Ω–æ –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å debounce

---

#### P2-5: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ Security.txt
**–ì–¥–µ:** –ö–æ—Ä–µ–Ω—å –ø—Ä–æ–µ–∫—Ç–∞  
**–†–∏—Å–∫:** –ù–µ—Ç —Å–ø–æ—Å–æ–±–∞ —Å–≤—è–∑–∞—Ç—å—Å—è –¥–ª—è security issues  
**–§–∏–∫—Å:**
- –°–æ–∑–¥–∞—Ç—å `/public/.well-known/security.txt`

---

## ASSUMPTIONS

1. **Deployment:** –ü—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç—Å—è –¥–µ–ø–ª–æ–π –Ω–∞ Vercel (Edge-compatible —Ä–µ—à–µ–Ω–∏—è)
2. **Database:** SQLite –≤ dev, –≤–æ–∑–º–æ–∂–Ω–æ PostgreSQL –≤ prod (–Ω—É–∂–Ω–æ —É—á–µ—Å—Ç—å –ø—Ä–∏ –º–∏–≥—Ä–∞—Ü–∏–∏)
3. **Auth:** –¢–µ–∫—É—â–∞—è –ø—Ä–æ—Å—Ç–∞—è cookie-based auth –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–∞ –¥–ª—è MVP, –Ω–æ –≤ –±—É–¥—É—â–µ–º –Ω—É–∂–µ–Ω proper auth (NextAuth/Clerk)
4. **HTTPS:** –ü—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç—Å—è —á—Ç–æ –≤ production –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è HTTPS (–¥–ª—è HSTS)
5. **Environment:** `.env` —Ñ–∞–π–ª—ã –Ω–µ –∫–æ–º–º–∏—Ç—è—Ç—Å—è (–ø—Ä–æ–≤–µ—Ä–µ–Ω–æ –≤ `.gitignore`)

---

## SUMMARY TABLE

| ID | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç | –ö–∞—Ç–µ–≥–æ—Ä–∏—è | –°—Ç–∞—Ç—É—Å | –§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è |
|----|-----------|-----------|--------|---------------------|
| P0-1 | üî¥ P0 | Headers | ‚ùå | `next.config.ts`, `src/middleware.ts` |
| P0-2 | üî¥ P0 | Rate Limiting | ‚ùå | `src/lib/rateLimit.ts`, –≤—Å–µ API routes |
| P0-3 | üî¥ P0 | Enumeration | ‚ùå | `src/app/api/auth/login/route.ts` |
| P0-4 | üî¥ P0 | CSRF | ‚ùå | `src/lib/csrf.ts`, middleware, API routes |
| P0-5 | üî¥ P0 | IDOR | ‚ùå | `src/lib/authorize.ts`, calendar/schedule routes |
| P0-6 | üî¥ P0 | Error Handling | ‚ùå | `src/lib/errors.ts`, –≤—Å–µ API routes |
| P0-7 | üî¥ P0 | Env Validation | ‚ùå | `src/lib/env.ts`, `.env.example` |
| P0-8 | üî¥ P0 | Cookies | ‚ùå | `src/app/api/auth/login/route.ts` |
| P0-9 | üî¥ P0 | Timing | ‚ùå | `src/lib/auth.ts` |
| P0-10 | üî¥ P0 | Logging | ‚ùå | `src/lib/logger.ts`, –≤—Å–µ API routes |
| P0-11 | üî¥ P0 | Mass Assignment | ‚ö†Ô∏è | Validation schemas |
| P0-12 | üî¥ P0 | Dependencies | ‚ùå | CI config, dependabot |
| P1-1 | üü† P1 | XSS | ‚ö†Ô∏è | –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ |
| P1-2 | üü† P1 | Pagination | ‚ùå | API routes |
| P1-3 | üü† P1 | Admin Routes | ‚ùå | `src/middleware.ts` |
| P1-4 | üü† P1 | Idempotency | ‚ùå | POST/PATCH routes |
| P1-5 | üü† P1 | Timeout | ‚ùå | Next.js config |
| P1-6 | üü† P1 | CORS | ‚ö†Ô∏è | `next.config.ts` |
| P1-7 | üü† P1 | SQL Injection | ‚úÖ | –ü—Ä–æ–≤–µ—Ä–∫–∞ Prisma |
| P1-8 | üü† P1 | Audit Log | ‚ùå | API routes |

---

## NEXT STEPS

–°–º. `SECURITY_PLAN.md` –¥–ª—è –ø–æ—à–∞–≥–æ–≤–æ–≥–æ –ø–ª–∞–Ω–∞ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π.
